"use strict";(self.webpackChunkdocumentation=self.webpackChunkdocumentation||[]).push([[2968],{3905:(e,n,t)=>{t.d(n,{Zo:()=>p,kt:()=>b});var o=t(67294);function r(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function a(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,o)}return t}function i(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?a(Object(t),!0).forEach((function(n){r(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):a(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function c(e,n){if(null==e)return{};var t,o,r=function(e,n){if(null==e)return{};var t,o,r={},a=Object.keys(e);for(o=0;o<a.length;o++)t=a[o],n.indexOf(t)>=0||(r[t]=e[t]);return r}(e,n);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(o=0;o<a.length;o++)t=a[o],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(r[t]=e[t])}return r}var s=o.createContext({}),l=function(e){var n=o.useContext(s),t=n;return e&&(t="function"==typeof e?e(n):i(i({},n),e)),t},p=function(e){var n=l(e.components);return o.createElement(s.Provider,{value:n},e.children)},u="mdxType",d={inlineCode:"code",wrapper:function(e){var n=e.children;return o.createElement(o.Fragment,{},n)}},m=o.forwardRef((function(e,n){var t=e.components,r=e.mdxType,a=e.originalType,s=e.parentName,p=c(e,["components","mdxType","originalType","parentName"]),u=l(t),m=r,b=u["".concat(s,".").concat(m)]||u[m]||d[m]||a;return t?o.createElement(b,i(i({ref:n},p),{},{components:t})):o.createElement(b,i({ref:n},p))}));function b(e,n){var t=arguments,r=n&&n.mdxType;if("string"==typeof e||r){var a=t.length,i=new Array(a);i[0]=m;var c={};for(var s in n)hasOwnProperty.call(n,s)&&(c[s]=n[s]);c.originalType=e,c[u]="string"==typeof e?e:r,i[1]=c;for(var l=2;l<a;l++)i[l]=t[l];return o.createElement.apply(null,i)}return o.createElement.apply(null,t)}m.displayName="MDXCreateElement"},56933:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>u,contentTitle:()=>l,default:()=>h,frontMatter:()=>s,metadata:()=>p,toc:()=>d});var o=t(87462),r=t(63366),a=t(67294),i=t(3905),c=["components"],s={title:"Step 7: Cross Communication",description:"tutorial step to explain how MFEs can communicate in micro-lc",sidebar_label:"Step 7: Cross Communication",sidebar_position:60},l=void 0,p={unversionedId:"docs/compose-your-frontend/communication",id:"docs/compose-your-frontend/communication",title:"Step 7: Cross Communication",description:"tutorial step to explain how MFEs can communicate in micro-lc",source:"@site/docs/docs/compose-your-frontend/07-communication.md",sourceDirName:"docs/compose-your-frontend",slug:"/docs/compose-your-frontend/communication",permalink:"/docs/compose-your-frontend/communication",draft:!1,editUrl:"https://github.com/micro-lc/documentation/edit/main/docs/docs/compose-your-frontend/07-communication.md",tags:[],version:"current",lastUpdatedBy:"Umberto Toniolo",sidebarPosition:60,frontMatter:{title:"Step 7: Cross Communication",description:"tutorial step to explain how MFEs can communicate in micro-lc",sidebar_label:"Step 7: Cross Communication",sidebar_position:60},sidebar:"docs",previous:{title:"Step 6: Make your parcel",permalink:"/docs/compose-your-frontend/make-your-parcel"},next:{title:"Step 8: Webserver",permalink:"/docs/compose-your-frontend/webserver"}},u={},d=[],m={toc:d},b="wrapper";function h(e){var n=e.components,t=(0,r.Z)(e,c);return(0,i.kt)(b,(0,o.Z)({},m,t,{components:n,mdxType:"MDXLayout"}),(0,i.kt)("p",null,"Let's associate the increment of a number to the click event on the ",(0,i.kt)("inlineCode",{parentName:"p"},"Click Me!")," button of the custom\nparcel. Let's also assume we would like to pass such number as a state across ",(0,i.kt)("micro-lc",null),"."),(0,i.kt)("p",null,"Every webcomponent mounted via ",(0,i.kt)("inlineCode",{parentName:"p"},"compose")," integration mode, and every parcel have access to a shared, extendable\nAPI."),(0,i.kt)("p",null,(0,i.kt)("micro-lc",null)," ",(0,i.kt)("a",{parentName:"p",href:"/api/micro-lc-api/"},"API")," has methods to extend itself. We can add a shared feature like a counter"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-javascript"},"var microlcApi // = defined here\n\nmicrolcApi.setExtension(\n  'counter',\n  {\n    get() {\n      return this.state\n    },\n    increment() {\n      this.state += 1\n      window.dispatchEvent(\n        new CustomEvent('increment-counter', { detail: this.state })\n      )\n    },\n    state: 0,\n    subscribe(handler) {\n      window.addEventListener('increment-counter', (e) => handler(e.detail))\n    },\n  }\n)\n")),(0,i.kt)("p",null,"and then retrieve the extension somewhere else"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-javascript"},"var microlcApi // = defined here\n\nconst {counter} = microlcApi.getExtensions()\n\nconsole.log(counter.get()) // prints 0\n")),(0,i.kt)("p",null,"Let's embed it in out custom parcel by retrieving the ",(0,i.kt)("micro-lc",null)," API from the mount arguments"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-javascript",metastring:"title=main.js",title:"main.js"},"(() => {\n  // ... rest of the code\n  \n  const mount = async (props) => {\n    container = props.container\n\n    // \ud83d\udc47 get the API\n    const {microlcApi} = props\n    // \ud83d\udc47 set the extension\n    const extensions = microlcApi.setExtension(\n      'counter',\n      {\n        get() {\n          return this.state\n        },\n        increment() {\n          this.state += 1\n          window.dispatchEvent(\n            new CustomEvent('increment-counter', { detail: this.state })\n          )\n        },\n        state: 0,\n        subscribe(handler) {\n          window.addEventListener('increment-counter', (e) => handler(e.detail))\n        }\n      }\n    )\n\n    const div = window.document.createElement('div')\n    const button = window.document.createElement('button')\n    Object.assign(\n      div.style,\n      {\n        alignItems: 'center',\n        display: 'flex',\n        flexDirection: 'column',\n        height: '100%',\n        justifyContent: 'center',\n        textAlign: 'center',\n      }\n    )\n\n    button.textContent = '+1' // \ud83d\udc48 better label\n    button.onclick = () => extensions.counter.increment() // \ud83d\udc48 increment counter\n\n    div.appendChild(button)\n    props.container.appendChild(div)\n\n    return null\n  }\n  \n  // ... rest of the code\n})()\n")),(0,i.kt)("p",null,"Then we can fix some CSS"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "sources": [...],\n  "content": {\n    "tag": "div",\n    "attributes": {\n      "style": "display: flex; justify-content: space-around; height: inherit;" \ud83d\udc48 some height here\n    },\n    "content": [\n      {\n        "tag": "microfrontend-loader",\n        "attributes": {\n          "style": "flex-grow: 1; background-color: #e6f7ff;" \ud83d\udc48 fancy background here\n        },\n        "properties": {\n          "application": {\n            "integrationMode": "parcel",\n            "entry": {\n              "scripts": [\n                "\ud83d\udcc4 paste base64 main.js code here" \ud83d\udc48 paste code\n              ]\n            }\n          }\n        }\n      },\n      {\n        "tag": "microfrontend-loader",\n        "attributes": {\n          "style": "flex-grow: 1;"\n        },\n        "properties": {\n          "application": {\n            "integrationMode": "parcel",\n            "entry": "https://cdn.mia-platform.eu/micro-lc/examples/0.1.3/static/parcels/react-memory-router/index.html"\n          }\n        }\n      }\n    ]\n  }\n}\n')),(0,i.kt)("p",null,"Let's then embed another custom parcel application with a number display, on the right handside, instead of the in-memory router React parcel."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-javascript",metastring:"title=display.js",title:"display.js"},"(() => {\n  // \ud83e\uddf1 mount application here\n  let container = null\n\n  // define the 'exports' object\n  const exports = {}\n  window['display-parcel'] = exports\n\n  // define the parcel lifecycle\n  // \ud83d\udc47 bootstrap\n  const bootstrap = async () => null\n\n  // \ud83d\udc47 mount: called when route is activated\n  const mount = async (props) => {\n    container = props.container\n\n    // \ud83d\udc47 get the API\n    const { microlcApi } = props\n\n    const div = window.document.createElement('div')\n    div.textContent = '0'\n    microlcApi.getExtensions().counter.subscribe((count) => {div.textContent = count})\n    Object.assign(div.style, {\n      alignItems: 'center',\n      display: 'flex',\n      flexDirection: 'column',\n      height: '100%',\n      justifyContent: 'center',\n      textAlign: 'center',\n    })\n    props.container.appendChild(div)\n\n    return null\n  }\n\n  // \ud83d\udc47 unmount: called when another route is activated\n  const unmount = async () => {\n    if (container !== null) {\n      container.childNodes.forEach((element) => element.remove())\n    }\n\n    return (container = null)\n  }\n\n  exports.bootstrap = bootstrap\n  exports.mount = mount\n  exports.unmount = unmount\n})()\n")),(0,i.kt)("p",null,"again by using the data protocol we can add it on the right side"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "sources": [...],\n  "content": {\n    "tag": "div",\n    "attributes": {\n      "style": "display: flex; justify-content: space-around; height: inherit;"\n    },\n    "content": [\n      {\n        ...\n      },\n      {\n        "tag": "microfrontend-loader",\n        "attributes": {\n          "style": "flex-grow: 1; background-color: #fffcdd" \ud83d\udc48 another fancy background here\n        },\n        "properties": {\n          "application": {\n            "integrationMode": "parcel",\n            "entry": {\n              "scripts": [\n                "\ud83d\udcc4 paste base64 display.js code here" \ud83d\udc48 paste code\n              ]\n            }\n          }\n        }\n      }\n    ]\n  }\n}\n')),(0,i.kt)("p",null,"and by click on the left it adds to the counter on the right."),(0,i.kt)(a.Fragment,null),(0,i.kt)("tutorial-frame",{configuration:{version:2,applications:{home:{integrationMode:"compose",route:"/",config:{content:{tag:"div",attributes:{style:"height: 100%; display: flex; flex-direction: column; justify-content: center; align-items: center; row-gap: 24px; font-family: Arial;"},content:[{tag:"img",attributes:{alt:"logo",src:"https://cdn.mia-platform.eu/micro-lc/orchestrator/2.2.0/dist/favicon.png"}},{tag:"bk-button",properties:{content:"Go to official documentation",action:{type:"href",config:{href:"https://micro-lc.io/",target:"_blank"}}}}]},sources:["https://cdn.jsdelivr.net/npm/@micro-lc/bk-web-components/dist/bk-web-components.esm.js"]}},about:{integrationMode:"iframe",route:"/about",src:"https://example.com/"},hash:{integrationMode:"parcel",route:"/hash/",entry:"https://cdn.mia-platform.eu/micro-lc/examples/0.1.3/static/parcels/react-hash-router/index.html"},browser:{integrationMode:"parcel",route:"/browser/",injectBase:!0,entry:"https://cdn.mia-platform.eu/micro-lc/examples/0.1.3/static/parcels/react-browser-router/index.html"},angular:{integrationMode:"parcel",route:"/angular/",injectBase:"override",entry:"https://cdn.mia-platform.eu/micro-lc/examples/0.1.3/static/parcels/angular13/index.html"},custom:{integrationMode:"compose",route:"/custom",config:{sources:["https://cdn.jsdelivr.net/npm/@micro-lc/orchestrator/dist/microfrontend-loader.js"],content:{tag:"div",attributes:{style:"display: flex; justify-content: space-around; height: 100%;"},content:[{tag:"microfrontend-loader",attributes:{style:"flex-grow: 1; background-color: #e6f7ff;"},properties:{application:{integrationMode:"parcel",entry:{scripts:["data:text/javascript;base64,InVzZSBzdHJpY3QiOygoKT0+e2xldCBuPW51bGw7Y29uc3QgZT17fTt3aW5kb3dbImN1c3RvbS1wYXJjZWwiXT1lO2NvbnN0IGk9YXN5bmMoKT0+bnVsbCxzPWFzeW5jIHQ9PntuPXQuY29udGFpbmVyO2NvbnN0e21pY3JvbGNBcGk6bH09dCx1PWwuc2V0RXh0ZW5zaW9uKCJjb3VudGVyIix7Z2V0KCl7cmV0dXJuIHRoaXMuc3RhdGV9LGluY3JlbWVudCgpe3RoaXMuc3RhdGUrPTEsd2luZG93LmRpc3BhdGNoRXZlbnQobmV3IEN1c3RvbUV2ZW50KCJpbmNyZW1lbnQtY291bnRlciIse2RldGFpbDp0aGlzLnN0YXRlfSkpfSxzdGF0ZTowLHN1YnNjcmliZShhKXtyZXR1cm4gd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoImluY3JlbWVudC1jb3VudGVyIixkPT5hKGQuZGV0YWlsKSl9fSksbz13aW5kb3cuZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiZGl2IiksYz13aW5kb3cuZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiYnV0dG9uIik7cmV0dXJuIE9iamVjdC5hc3NpZ24oby5zdHlsZSx7YWxpZ25JdGVtczoiY2VudGVyIixkaXNwbGF5OiJmbGV4IixmbGV4RGlyZWN0aW9uOiJjb2x1bW4iLGhlaWdodDoiMTAwJSIsanVzdGlmeUNvbnRlbnQ6ImNlbnRlciIsdGV4dEFsaWduOiJjZW50ZXIifSksYy50ZXh0Q29udGVudD0iKzEiLGMuYWRkRXZlbnRMaXN0ZW5lcigiY2xpY2siLCgpPT51LmNvdW50ZXIuaW5jcmVtZW50KCkpLG8uYXBwZW5kQ2hpbGQoYyksdC5jb250YWluZXIuYXBwZW5kQ2hpbGQobyksbnVsbH0scj1hc3luYygpPT4obiE9PW51bGwmJm4uY2hpbGROb2Rlcy5mb3JFYWNoKHQ9PnQucmVtb3ZlKCkpLG49bnVsbCk7ZS5ib290c3RyYXA9aSxlLm1vdW50PXMsZS51bm1vdW50PXJ9KSgpOwo="]}}}},{tag:"microfrontend-loader",attributes:{style:"flex-grow: 1; background-color: #fffcdd"},properties:{application:{integrationMode:"parcel",entry:{scripts:["data:text/javascript;base64,InVzZSBzdHJpY3QiOygoKT0+e2xldCB0PW51bGw7Y29uc3QgZT17fTt3aW5kb3dbImRpc3BsYXktcGFyY2VsIl09ZTtjb25zdCBjPWFzeW5jKCk9Pm51bGwsaT1hc3luYyBuPT57dD1uLmNvbnRhaW5lcjtjb25zdHttaWNyb2xjQXBpOnN9PW4sbz13aW5kb3cuZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiZGl2Iik7cmV0dXJuIG8udGV4dENvbnRlbnQ9IjAiLHMuZ2V0RXh0ZW5zaW9ucygpLmNvdW50ZXIuc3Vic2NyaWJlKHI9PntvLnRleHRDb250ZW50PVN0cmluZyhyKX0pLE9iamVjdC5hc3NpZ24oby5zdHlsZSx7YWxpZ25JdGVtczoiY2VudGVyIixkaXNwbGF5OiJmbGV4IixmbGV4RGlyZWN0aW9uOiJjb2x1bW4iLGhlaWdodDoiMTAwJSIsanVzdGlmeUNvbnRlbnQ6ImNlbnRlciIsdGV4dEFsaWduOiJjZW50ZXIifSksbi5jb250YWluZXIuYXBwZW5kQ2hpbGQobyksbnVsbH0sbD1hc3luYygpPT4odCE9PW51bGwmJnQuY2hpbGROb2Rlcy5mb3JFYWNoKG49Pm4ucmVtb3ZlKCkpLHQ9bnVsbCk7ZS5ib290c3RyYXA9YyxlLm1vdW50PWksZS51bm1vdW50PWx9KSgpOwo="]}}}}]}}}},layout:{content:{tag:"bk-layout",properties:{logo:{url:"https://avatars.githubusercontent.com/u/92730708?s=200&v=4"},menuItems:[{icon:{library:"@ant-design/icons-svg",selector:"HomeOutlined"},id:"home",label:"Home",type:"application"},{icon:{library:"@ant-design/icons-svg",selector:"ContactsOutlined"},id:"about",label:"About",type:"application"},{icon:{library:"@fortawesome/free-solid-svg-icons",selector:"faHashtag"},id:"hash",label:"Hash",type:"application"},{icon:{library:"@fortawesome/free-brands-svg-icons",selector:"faReact"},id:"browser",label:"Browser",type:"application"},{icon:{library:"@fortawesome/free-brands-svg-icons",selector:"faAngular"},id:"angular",label:"Angular",type:"application"},{icon:{library:"@fortawesome/free-solid-svg-icons",selector:"faBox"},id:"custom",label:"Custom",type:"application"}]}},sources:["https://cdn.jsdelivr.net/npm/@micro-lc/bk-web-components/dist/bk-web-components.esm.js"]}}}),(0,i.kt)("p",null,(0,i.kt)("micro-lc",null)," API ",(0,i.kt)("a",{parentName:"p",href:"/api/micro-lc-api/"},"supports")," several methods and actions that out\nof the box let you interact with the page."),(0,i.kt)("p",null,"Mainly, it allows to retrieve the overall configuration, the current application, routing APIs and more..."),(0,i.kt)("p",null,"Using the ",(0,i.kt)("micro-lc",null)," API allows cross communication between any parcel or compose application and the\nlayout of ",(0,i.kt)("micro-lc",null)," and also state persistence amongst microfrontend applications whether mounted or\nnot."))}h.isMDXComponent=!0}}]);